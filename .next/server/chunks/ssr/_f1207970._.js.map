{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/breadcrumb.tsx"],"sourcesContent":["import Link from \"next/link\"\r\nimport { ChevronRight } from \"lucide-react\"\r\n\r\ninterface BreadcrumbProps {\r\n  items: string[];\r\n}\r\n\r\nexport function Breadcrumb({ items }: BreadcrumbProps) {\r\n  return (\r\n    <div className=\"px-6 pt-3 flex items-center text-sm\">\r\n      {items.map((item, index) => (\r\n        <div key={index} className=\"flex items-center\">\r\n          {index > 0 && <ChevronRight size={16} className=\"mx-2 text-black\" />}\r\n          <Link\r\n            href=\"#\"\r\n            // TODO: Replace '#' with actual item.href if available\r\n\r\n            className={`${\r\n              index === items.length - 1 ? \"text-gray-800 font-medium\" : \"text-black hover:text-gray-700\"\r\n            }`}\r\n          >\r\n            {item}\r\n          </Link>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAMO,SAAS,WAAW,EAAE,KAAK,EAAmB;IACnD,qBACE,8OAAC;QAAI,WAAU;kBACZ,MAAM,GAAG,CAAC,CAAC,MAAM,sBAChB,8OAAC;gBAAgB,WAAU;;oBACxB,QAAQ,mBAAK,8OAAC,sNAAA,CAAA,eAAY;wBAAC,MAAM;wBAAI,WAAU;;;;;;kCAChD,8OAAC,4JAAA,CAAA,UAAI;wBACH,MAAK;wBACL,uDAAuD;wBAEvD,WAAW,GACT,UAAU,MAAM,MAAM,GAAG,IAAI,8BAA8B,kCAC3D;kCAED;;;;;;;eAVK;;;;;;;;;;AAgBlB","debugId":null}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/real-time/bill-details.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { MoreVertical } from \"lucide-react\";\r\nimport { APISDK, IDineInTable } from \"@/libs/api\";\r\nimport { usePopup } from \"@/context/popup-context\";\r\n\r\ninterface BillItem {\r\n  name: string;\r\n  quantity: number;\r\n  price: number;\r\n}\r\n\r\ninterface Bill {\r\n  tableId: string;\r\n  items: BillItem[];\r\n  subtotal: number;\r\n  discount: { percentage: number; amount: number };\r\n  gst: { percentage: number; amount: number };\r\n  grandTotal: number;\r\n  checkout_id: string | null;\r\n  booking_id: string | null;\r\n}\r\n\r\ninterface BillDetailsProps {\r\n  bill?: Bill;\r\n  onUpdateCapacityAction: (capacity: number) => void;\r\n  table?: IDineInTable; // Add tableId as optional prop for when bill is not provided\r\n}\r\n\r\nexport function BillDetails({ bill, onUpdateCapacityAction, table }: BillDetailsProps) {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const [showTableDetails, setShowTableDetails] = useState(false);\r\n  const [isCompleting, setIsCompleting] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n  const tableDetailsRef = useRef<HTMLDivElement>(null);\r\n  const { showPopup } = usePopup();\r\n  const [isForcedCheckout, setIsForcedCheckout] = useState(false);\r\nconsole.log('billname',bill, table);\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      // Handle menu click outside\r\n      if (\r\n        menuRef.current &&\r\n        !menuRef.current.contains(event.target as Node) &&\r\n        buttonRef.current &&\r\n        !buttonRef.current.contains(event.target as Node)\r\n      ) {\r\n        setShowMenu(false);\r\n      }\r\n\r\n      // Handle table details modal click outside\r\n      if (\r\n        tableDetailsRef.current &&\r\n        !tableDetailsRef.current.contains(event.target as Node)\r\n      ) {\r\n        setShowTableDetails(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, []);\r\n\r\n  const handleComplete = async (\r\n    checkout_id: string,\r\n    booking_id: string,\r\n  ) => {\r\n    setIsCompleting(true);\r\n    const token = localStorage.getItem(\"access_token\");\r\n    if (!token) {\r\n      setIsCompleting(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const api = APISDK.getInstance(token);\r\n\r\n      await api.updateCheckout(checkout_id, {\r\n        is_checked_out: true,\r\n        payment_status: \"Completed\",\r\n        payment_date: new Date(),\r\n      });\r\n\r\n      await api.markBookingAsCompleted(booking_id);\r\n      showPopup(\"Payment completed successfully\", { type: \"success\" });\r\n    } catch (error) {\r\n      console.error(\"Failed to complete payment:\", error);\r\n      showPopup(\"Failed to complete payment\", { type: \"error\" });\r\n    } finally {\r\n      setIsCompleting(false);\r\n    }\r\n  };\r\n\r\n  const handleForcedCheckout = async () => {\r\n    if (!bill?.booking_id) {\r\n      console.error(\"No booking ID found\");\r\n      return;\r\n    }\r\n\r\n    setIsForcedCheckout(true);\r\n    try {\r\n      const token = localStorage.getItem(\"access_token\");\r\n      if (!token) {\r\n        throw new Error(\"No access token found\");\r\n      }\r\n\r\n      const api = APISDK.getInstance(token);\r\n      await api.createUserEndCheckout(bill.booking_id);\r\n\r\n      // Show success message\r\n      showPopup(\"Forced checkout completed successfully\", {\r\n        type: \"success\",\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to force checkout:\", error);\r\n      showPopup(\"Failed to complete forced checkout\", {\r\n        type: \"error\",\r\n      });\r\n    } finally {\r\n      setIsForcedCheckout(false);\r\n    }\r\n  };\r\n\r\n  const toggleMenu = () => {\r\n    setShowMenu(!showMenu);\r\n  };\r\n\r\n  const handleDeleteBooking = async () => {\r\n    if (!bill?.booking_id) {\r\n      showPopup(\"No booking found to delete\", { type: \"error\" });\r\n      return;\r\n    }\r\n  \r\n    if (window.confirm(\"Are you sure you want to delete this booking? This action cannot be undone.\")) {\r\n      try {\r\n        const token = localStorage.getItem(\"access_token\");\r\n        if (!token) {\r\n          throw new Error(\"No access token found\");\r\n        }\r\n  \r\n        const api = APISDK.getInstance(token);\r\n        await api.deleteBooking(bill.booking_id);\r\n        \r\n        showPopup(\"Booking deleted successfully\", { type: \"success\" });\r\n        setShowMenu(false);\r\n      } catch (error) {\r\n        console.error(\"Failed to delete booking:\", error);\r\n        showPopup(\"Failed to delete booking\", { type: \"error\" });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleTableDetails = () => {\r\n    setShowMenu(false);\r\n    setShowTableDetails(true);\r\n  };\r\n\r\n  const handleMarkAsCleaned = async (table_id: string) => {\r\n    const token = localStorage.getItem(\"access_token\");\r\n    if (!token) {\r\n      return;\r\n    }\r\n\r\n    const api = APISDK.getInstance(token);\r\n\r\n    try {\r\n      await api.markTableAsCleaned(table_id);\r\n      showPopup(\"Table marked as cleaned\", { type: \"success\" });\r\n    } catch (error) {\r\n      console.error(\"Error marking table as cleaned:\", error);\r\n      showPopup(\"Failed to mark table as cleaned\", { type: \"error\" });\r\n    }\r\n  }\r\n\r\n  const handleDeleteTable = async () => {\r\n    if (!table?.id) {\r\n      showPopup(\"Table ID not found\", { type: \"error\" });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const token = localStorage.getItem(\"access_token\");\r\n      if (!token) {\r\n        showPopup(\"Authentication required\", { type: \"error\" });\r\n        return;\r\n      }\r\n\r\n      const api = APISDK.getInstance(token);\r\n      await api.deleteTable(table.id);\r\n\r\n      setShowMenu(false);\r\n      showPopup(\"Table deleted successfully\", { type: \"success\" });\r\n\r\n      // Optionally, you might want to trigger a refresh of the parent component\r\n      // or navigate away from this component since the table no longer exists\r\n    } catch (error) {\r\n      showPopup(error instanceof Error ? error.message : \"Failed to delete table\", { type: \"error\" });\r\n    }\r\n  };\r\n\r\n  const handleCapacityChange = (newCapacity: number) => {\r\n    onUpdateCapacityAction(newCapacity);\r\n    setShowTableDetails(false);\r\n\r\n    showPopup(`Table capacity updated to ${newCapacity} seats`, { type: \"success\" });\r\n  };\r\n\r\n  if (!table) {\r\n    return (\r\n      <div className=\"bg-gray-100 border rounded-lg overflow-hidden relative\">\r\n        <div className=\"p-4\">\r\n          <p className=\"text-gray-500 text-center\">No table selected</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Determine the table ID to display\r\n  const displayTableId = bill?.tableId ?? table.table_number ?? \"N/A\";\r\n\r\n  if (!bill) {\r\n    return (\r\n      <div className=\"bg-gray-100 border rounded-lg overflow-hidden relative\">\r\n        <div className=\"p-4\">\r\n          <div className=\"flex items-center mb-4 justify-between\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center\">\r\n                <svg className=\"w-6 h-6 text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-medium text-gray-800\">Table - {displayTableId}</h3>\r\n                <p className=\"text-sm text-gray-500\">No active bill</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"relative\">\r\n              <button\r\n                ref={buttonRef}\r\n                onClick={toggleMenu}\r\n                className=\"p-2 rounded-xl cursor-pointer bg-gray-200 hover:bg-gray-300\"\r\n              >\r\n                <MoreVertical size={20} className=\"text-black \" />\r\n              </button>\r\n\r\n              {showMenu && (\r\n                <div ref={menuRef} className=\"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg z-10\">\r\n                  <div className=\"py-1 border rounded-md\">\r\n                    <button\r\n                      onClick={handleTableDetails}\r\n                      className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100\"\r\n                    >\r\n                      <svg className=\"w-4 h-4 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h7\" />\r\n                      </svg>\r\n                      Table Details\r\n                    </button>\r\n                    {bill && (\r\n                      <button\r\n                        onClick={handleDeleteBooking}\r\n                        className=\"flex items-center w-full px-4 py-2 text-sm text-orange-600 cursor-pointer hover:bg-gray-100\"\r\n                      >\r\n                        <svg className=\"w-4 h-4 mr-2 text-orange-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                        </svg>\r\n                        Delete Booking\r\n                      </button>\r\n                    )}\r\n                    <button\r\n                      onClick={handleDeleteTable}\r\n                      className=\"flex items-center w-full px-4 py-2 text-sm text-red-600 cursor-pointer hover:bg-gray-100\"\r\n                    >\r\n                      <svg className=\"w-4 h-4 mr-2 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                      Delete Table\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-center items-center h-48 bg-white/60 rounded-xl\">\r\n            <p className=\"text-gray-500 text-center\">No bill selected</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Table Details Modal */}\r\n        {showTableDetails && (\r\n          <div className=\"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50\">\r\n            <div ref={tableDetailsRef} className=\"bg-white rounded-lg w-full max-w-md mx-4\">\r\n              <div className=\"p-4\">\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <h3 className=\"text-lg text-black font-medium\">Table Details</h3>\r\n                  <button onClick={() => setShowTableDetails(false)} className=\"text-gray-500 cursor-pointer\">\r\n                    <svg className=\"w-5 h-5 cursor-pointer\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700\">Table Name</label>\r\n                    <div className=\"mt-1 text-gray-400 flex items-center justify-between\">\r\n                      <span>{displayTableId}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700\">Table Capacity</label>\r\n                    <div className=\"mt-2\">\r\n                      <select\r\n                        value={table.capacity}\r\n                        onChange={(e) => handleCapacityChange(Number(e.target.value))}\r\n                        className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      >\r\n                        <option value={1}>1 Seat</option>\r\n                        <option value={2}>2 Seats</option>\r\n                        <option value={3}>3 Seats</option>\r\n                        <option value={4}>4 Seats</option>\r\n                      </select>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <h4 className=\"block text-sm font-medium text-gray-700 mb-2\">Table QR</h4>\r\n                    <p className=\"text-xs text-gray-500 mb-2\">QR where users can order items from their table</p>\r\n                    <div className=\"flex justify-center mb-2\">\r\n                      <img src={table.meta_data.qr_code} alt=\"QR Code\" className=\"border\" />\r\n                    </div>\r\n                    <button className=\"w-full flex items-center justify-center py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\">\r\n                      <svg className=\"w-4 h-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                      </svg>\r\n                      <p className=\"cursor-pointer\">Download QR</p>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-gray-100 border rounded-lg overflow-hidden relative\">\r\n      <div className=\"p-4\">\r\n        <div className=\"flex items-center mb-4 justify-between\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center\">\r\n              <svg className=\"w-6 h-6 text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-medium text-gray-800\">Table - {bill.tableId}</h3>\r\n              <p className=\"text-sm text-gray-500\">{bill.items.length} items @ Rs {bill.subtotal}</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"relative\">\r\n            <button\r\n              ref={buttonRef}\r\n              onClick={toggleMenu}\r\n              className=\"p-2 rounded-xl cursor-pointer bg-gray-200 hover:bg-gray-300\"\r\n            >\r\n              <MoreVertical size={20} className=\"text-black \" />\r\n            </button>\r\n\r\n            {showMenu && (\r\n              <div ref={menuRef} className=\"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg z-10\">\r\n                <div className=\"py-1 border rounded-md\">\r\n                  <button\r\n                    onClick={handleTableDetails}\r\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h7\" />\r\n                    </svg>\r\n                    Table Details\r\n                  </button>\r\n                  <button\r\n                        onClick={handleDeleteBooking}\r\n                        className=\"flex items-center w-full px-4 py-2 text-sm text-orange-600 cursor-pointer hover:bg-gray-100\"\r\n                      >\r\n                        <svg className=\"w-4 h-4 mr-2 text-orange-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                        </svg>\r\n                        Delete Booking\r\n                      </button>\r\n                  <button\r\n                    onClick={handleDeleteTable}\r\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-red-600 cursor-pointer hover:bg-gray-100\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 mr-2 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                    </svg>\r\n                    Delete Table\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-3 mb-4 bg-white/60 rounded-xl p-4\">\r\n          {bill.items.map((item, index) => (\r\n            <div key={index} className=\"flex justify-between \">\r\n              <div className=\"flex items-center\">\r\n                <span className=\"text-gray-500\">{item.name}</span>\r\n                <span className=\"text-gray-500 text-sm ml-2\">×{item.quantity}</span>\r\n              </div>\r\n              <span className=\"text-gray-700\">₹ {item.price}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"border-t pt-3 space-y-2 p-4\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Total</span>\r\n            <span className=\"font-medium text-gray-700\">{bill.subtotal}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-500\">\r\n              Discount <span className=\"text-sm\">{bill.discount.percentage}%</span>\r\n            </span>\r\n            <span className=\"text-gray-700\">₹ {bill.discount.amount}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">\r\n              GST <span className=\"text-sm\">{bill.gst.percentage}%</span>\r\n            </span>\r\n            <span className=\"text-gray-700\">₹ {bill.gst.amount}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4 bg-orange-500 text-white p-3 cursor-pointer rounded-md flex justify-between\">\r\n          <span className=\"font-medium\">Grand Total</span>\r\n          <span className=\"font-medium\">₹ {bill.grandTotal}</span>\r\n        </div>\r\n\r\n        <div className=\"mt-4 flex flex-col gap-3\">\r\n          <button\r\n            onClick={handleForcedCheckout}\r\n            disabled={isForcedCheckout || !bill?.booking_id}\r\n            className={`py-3 w-full flex items-center justify-center rounded-md transition-colors duration-200 ${isForcedCheckout || !bill?.booking_id\r\n                ? 'bg-gray-400 cursor-not-allowed text-white'\r\n                : 'bg-red-500 hover:bg-red-600 text-white cursor-pointer'\r\n              }`}\r\n          >\r\n            {isForcedCheckout ? (\r\n              <>\r\n                <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n                Processing Checkout...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <svg className=\"w-5 h-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n                </svg>\r\n                Force Checkout\r\n              </>\r\n            )}\r\n          </button>\r\n          <button\r\n            onClick={async () => {\r\n              await handleComplete(bill.checkout_id!, bill.booking_id!);\r\n            }}\r\n            disabled={isCompleting}\r\n            className={`py-3 w-full bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center justify-center transition-colors duration-200 ${isCompleting ? 'cursor-not-allowed opacity-70 bg-green-400' : 'cursor-pointer'\r\n              }`}\r\n          >\r\n            {isCompleting ? (\r\n              <>\r\n                <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n                Processing...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <svg className=\"w-5 h-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                </svg>\r\n                Mark as completed\r\n              </>\r\n            )}\r\n          </button>\r\n          <button\r\n            onClick={async () => {\r\n              await handleMarkAsCleaned(table.id);\r\n            }}\r\n            className=\"py-3 w-full bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center justify-center transition-colors duration-200\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n            </svg>\r\n            Mark as Cleaned\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table Details Modal */}\r\n      {showTableDetails && (\r\n        <div className=\"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div ref={tableDetailsRef} className=\"bg-white rounded-lg w-full max-w-md mx-4\">\r\n            <div className=\"p-4\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h3 className=\"text-lg text-black font-medium\">Table Details</h3>\r\n                <button onClick={() => setShowTableDetails(false)} className=\"text-gray-500 cursor-pointer\">\r\n                  <svg className=\"w-5 h-5 cursor-pointer\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700\">Table Name</label>\r\n                  <div className=\"mt-1 text-gray-400 flex items-center justify-between\">\r\n                    <span>{bill.tableId}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700\">Table Capacity</label>\r\n                  <div className=\"mt-2\">\r\n                    <select\r\n                      value={table.capacity}\r\n                      onChange={(e) => handleCapacityChange(Number(e.target.value))}\r\n                      className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    >\r\n                      <option value={1}>1 Seat</option>\r\n                      <option value={2}>2 Seats</option>\r\n                      <option value={3}>3 Seats</option>\r\n                      <option value={4}>4 Seats</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"block text-sm font-medium text-gray-700 mb-2\">Table QR</h4>\r\n                  <p className=\"text-xs text-gray-500 mb-2\">QR where users can order items from their table</p>\r\n                  <div className=\"flex justify-center mb-2\">\r\n                    <img src={table.meta_data.qr_code} alt=\"QR Code\" className=\"border\" />\r\n                  </div>\r\n                  <button className=\"w-full flex items-center justify-center py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\">\r\n                    <svg className=\"w-4 h-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                    </svg>\r\n                    <p className=\"cursor-pointer\">Download QR</p>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1633, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/real-time/table-legend.tsx"],"sourcesContent":["export function TableLegend(\r\n  {\r\n    statuses\r\n  }: Readonly<{\r\n    statuses: {\r\n      name: string;\r\n      color: string;\r\n    }[];\r\n  }>\r\n) {\r\n  return (\r\n    <div className=\"flex flex-wrap gap-4 justify-center\">\r\n      {statuses.map((status) => (\r\n        <div key={status.name} className=\"flex items-center px-2 border-2 py-1 rounded-md\">\r\n          <span className={`inline-block w-3 h-3 rounded-full ${status.color} mr-2`}></span>\r\n          <span className=\"text-sm text-gray-600\">{status.name}</span>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAO,SAAS,YACd,EACE,QAAQ,EAMR;IAEF,qBACE,8OAAC;QAAI,WAAU;kBACZ,SAAS,GAAG,CAAC,CAAC,uBACb,8OAAC;gBAAsB,WAAU;;kCAC/B,8OAAC;wBAAK,WAAW,CAAC,kCAAkC,EAAE,OAAO,KAAK,CAAC,KAAK,CAAC;;;;;;kCACzE,8OAAC;wBAAK,WAAU;kCAAyB,OAAO,IAAI;;;;;;;eAF5C,OAAO,IAAI;;;;;;;;;;AAO7B","debugId":null}},
    {"offset": {"line": 1677, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/real-time/new-table-modal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { X } from \"lucide-react\";\r\n\r\ninterface NewTableModalProps {\r\n  isOpen: boolean;\r\n  onCloseAction: () => void;\r\n  onAddTableAction: (tableData: { name: string; capacity: number }) => Promise<void>;\r\n}\r\n\r\nexport function NewTableModal({ isOpen, onCloseAction, onAddTableAction }: NewTableModalProps) {\r\n  const [tableName, setTableName] = useState(\"\");\r\n  const [capacity, setCapacity] = useState(4);\r\n  const modalRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (modalRef.current && !modalRef.current.contains(event.target as Node)) {\r\n        onCloseAction();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen, onCloseAction]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    await onAddTableAction({ name: tableName, capacity });\r\n    onCloseAction();\r\n    setTableName(\"\");\r\n    setCapacity(4);\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div ref={modalRef} className=\"bg-white rounded-lg w-full max-w-md mx-4\">\r\n        <div className=\"p-6\">\r\n          <div className=\"flex justify-between items-center mb-4\">\r\n            <h3 className=\"text-lg text-black font-medium\">Add New Table</h3>\r\n            <button onClick={onCloseAction} className=\"text-gray-500 hover:text-gray-700 cursor-pointer\">\r\n              <X size={20} />\r\n            </button>\r\n          </div>\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Table ID\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={tableName}\r\n                  onChange={(e) => setTableName(e.target.value)}\r\n                  placeholder=\"e.g. EX09\"\r\n                  className=\"w-full px-3 py-2 border rounded-md placeholder:text-gray-400 text-gray-600 focus:outline-none focus:ring-2 focus:ring-orange-500\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Seating Capacity\r\n                </label>\r\n                <select\r\n                  value={capacity}\r\n                  onChange={(e) => setCapacity(Number(e.target.value))}\r\n                  className=\"w-full px-3 py-2 border rounded-md focus:outline-none text-gray-600 focus:ring-2 focus:ring-orange-500\"\r\n                >\r\n                  <option value={1}>1 Seat</option>\r\n                  <option value={2}>2 Seats</option>\r\n                  <option value={3}>3 Seats</option>\r\n                  <option value={4}>4 Seats</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-3 mt-6\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onCloseAction}\r\n                  className=\"px-4 py-2 border rounded-md cursor-pointer text-gray-700 hover:bg-gray-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"px-4 py-2 bg-orange-500 cursor-pointer text-white rounded-md hover:bg-orange-600\"\r\n                >\r\n                  Add Table\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAWO,SAAS,cAAc,EAAE,MAAM,EAAE,aAAa,EAAE,gBAAgB,EAAsB;IAC3F,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAExC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,qBAAqB,CAAC;YAC1B,IAAI,SAAS,OAAO,IAAI,CAAC,SAAS,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBACxE;YACF;QACF;QAEA,IAAI,QAAQ;YACV,SAAS,gBAAgB,CAAC,aAAa;QACzC;QAEA,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG;QAAC;QAAQ;KAAc;IAE1B,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,MAAM,iBAAiB;YAAE,MAAM;YAAW;QAAS;QACnD;QACA,aAAa;QACb,YAAY;IACd;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,KAAK;YAAU,WAAU;sBAC5B,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAAiC;;;;;;0CAC/C,8OAAC;gCAAO,SAAS;gCAAe,WAAU;0CACxC,cAAA,8OAAC,4LAAA,CAAA,IAAC;oCAAC,MAAM;;;;;;;;;;;;;;;;;kCAIb,8OAAC;wBAAK,UAAU;kCACd,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;;sDACC,8OAAC;4CAAM,WAAU;sDAA+C;;;;;;sDAGhE,8OAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;4CAC5C,aAAY;4CACZ,WAAU;4CACV,QAAQ;;;;;;;;;;;;8CAIZ,8OAAC;;sDACC,8OAAC;4CAAM,WAAU;sDAA+C;;;;;;sDAGhE,8OAAC;4CACC,OAAO;4CACP,UAAU,CAAC,IAAM,YAAY,OAAO,EAAE,MAAM,CAAC,KAAK;4CAClD,WAAU;;8DAEV,8OAAC;oDAAO,OAAO;8DAAG;;;;;;8DAClB,8OAAC;oDAAO,OAAO;8DAAG;;;;;;8DAClB,8OAAC;oDAAO,OAAO;8DAAG;;;;;;8DAClB,8OAAC;oDAAO,OAAO;8DAAG;;;;;;;;;;;;;;;;;;8CAItB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,MAAK;4CACL,SAAS;4CACT,WAAU;sDACX;;;;;;sDAGD,8OAAC;4CACC,MAAK;4CACL,WAAU;sDACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjB","debugId":null}},
    {"offset": {"line": 1912, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/real-time/table-grid.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { BillDetails } from \"./bill-details\";\r\nimport { TableLegend } from \"./table-legend\";\r\nimport { Plus } from \"lucide-react\";\r\nimport { NewTableModal } from \"./new-table-modal\";\r\nimport { APISDK, IDineInTable } from \"@/libs/api\";\r\n\r\nexport type TableStatus = \"Active\" | \"Ready to Bill\" | \"To be Cleaned\" | \"Untouched\";\r\n\r\nexport default function TableGridSystem({\r\n  tables,\r\n  setTables,\r\n  tableStates,\r\n}: Readonly<{\r\n  tables: IDineInTable[],\r\n  setTables: React.Dispatch<React.SetStateAction<IDineInTable[]>>,\r\n  tableStates: IDineInTableStats[]\r\n}>) {\r\n  const statuses = [\r\n    { name: \"Active\", color: \"bg-green-400\" },\r\n    { name: \"Ready to Bill\", color: \"bg-orange-400\" },\r\n    { name: \"To be Cleaned\", color: \"bg-red-400\" },\r\n    { name: \"Untouched\", color: \"bg-gray-300\" },\r\n  ];\r\n\r\n  const [selectedTable, setSelectedTable] = useState(\"\");\r\n  const [showNewTableModal, setShowNewTableModal] = useState(false);\r\n\r\n  const [bills, setBills] = useState<Record<string, Bill>>({});\r\n  const [tableStatus, setTableStatus] = useState<{\r\n    [tableId: string]: TableStatus;\r\n  }>({});\r\n  useEffect(() => {\r\n    const newBills: Record<string, Bill> = {};\r\n    tableStates.forEach((stat) => {\r\n      setTableStatus((prev) => ({\r\n        ...prev,\r\n        [stat.table_number]: stat.status as TableStatus,\r\n      }));\r\n\r\n      newBills[stat.table_number] = {\r\n        tableId: stat.table_number,\r\n        items: stat.items.map((item) => ({\r\n          name: item.name,\r\n          quantity: item.quantity,\r\n          price: item.price,\r\n        })),\r\n        subtotal: stat.total_amount,\r\n        discount: { percentage: 0, amount: 0 },\r\n        gst: { percentage: 0, amount: 0 },\r\n        grandTotal: stat.total_amount,\r\n        checkout_id: stat.checkout_id ?? null,\r\n        booking_id: stat.booking_id ?? null,\r\n      };\r\n    });\r\n    \r\n    setBills(newBills);\r\n  }, [tableStates]);\r\n  console.log(\"table status\",tableStates)\r\n\r\n  const updateTableCapacity = (tableId: string, capacity: number) => {\r\n    setTables(prevTables =>\r\n      prevTables.map(table =>\r\n        table.id === tableId ? { ...table, capacity } : table\r\n      )\r\n    );\r\n  };\r\n\r\n  const handleAddTable = async (tableData: { name: string; capacity: number }) => {\r\n    try {\r\n      const api = APISDK.getInstance();\r\n      const newTable = await api.createTable({\r\n        table_number: tableData.name,\r\n        capacity: tableData.capacity,\r\n        meta_data: {\r\n          status: 'Untouched',\r\n          qr_code: `https://api.qrserver.com/v1/create-qr-code/?size=240x240&data=https://dine.jeevic.com/book-table/${tableData.name}`,\r\n        }\r\n      });\r\n      setTables([...tables, newTable.data]);\r\n    } catch (error) {\r\n      console.error(\"Error adding table:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 max-w-5xl mx-auto\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h3 className=\"text-lg font-medium text-gray-800\">Floor Layout</h3>\r\n        <button\r\n          onClick={() => setShowNewTableModal(true)}\r\n          className=\"flex items-center px-3 py-2 cursor-pointer bg-gray-200 text-gray-700 rounded-md hover:bg-orange-400\"\r\n        >\r\n          <Plus size={18} className=\"mr-1\" />\r\n          Add Table\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-[2fr,1fr] gap-4\">\r\n        <TableGrid \r\n          tables={tables} \r\n          selectedTable={selectedTable} \r\n          setSelectedTable={setSelectedTable} \r\n          statuses={statuses}\r\n          tableStatus={tableStatus}\r\n        />\r\n        <TableLegend statuses={statuses} />\r\n        <div className=\"mt-4\">\r\n          <div className=\"my-3 border-t pt-3 flex items-center text-sm text-gray-600\">\r\n            <span className=\"mr-2\">Table Management</span>\r\n            <span className=\"mx-2\">•</span>\r\n            <span className=\"font-medium mr-2\">{selectedTable}</span>\r\n          </div>\r\n          <BillDetails \r\n            bill={bills[selectedTable]} \r\n            onUpdateCapacityAction={(capacity: number) => updateTableCapacity(selectedTable, capacity)}\r\n            table={tables.find(t => t.table_number === selectedTable)}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <NewTableModal \r\n        isOpen={showNewTableModal}\r\n        onCloseAction={() => setShowNewTableModal(false)}\r\n        onAddTableAction={handleAddTable}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TableGrid({ \r\n  tables, \r\n  selectedTable, \r\n  setSelectedTable,\r\n  tableStatus\r\n}: Readonly<{ \r\n  tables: IDineInTable[], \r\n  selectedTable: string, \r\n  setSelectedTable: (id: string) => void,\r\n  statuses: { name: string; color: string }[],\r\n  tableStatus: { [tableId: string]: TableStatus }\r\n}>) {\r\n  const getTableColor = (status: TableStatus) => {\r\n    switch (status) {\r\n      case \"Active\":\r\n        return \"bg-green-400\";\r\n      case \"Ready to Bill\":\r\n        return \"bg-orange-400\";\r\n      case \"To be Cleaned\":\r\n        return \"bg-red-400\";\r\n      default:\r\n        return \"bg-gray-300\";\r\n    }\r\n  };\r\n\r\n  const renderTableSeats = (table: IDineInTable) => {\r\n    const seats = [];\r\n    \r\n    // Add seats based on capacity\r\n    if (table.capacity >= 1) {\r\n      // Left seat is always present for 1 or more seats\r\n      seats.push(\r\n        <div key=\"left\" className=\"absolute top-1/2 -left-2 transform -translate-y-1/2 w-2.5 h-14 bg-gray-100 rounded-full\"></div>\r\n      );\r\n    }\r\n    \r\n    if (table.capacity >= 2) {\r\n      // Right seat for 2 or more seats\r\n      seats.push(\r\n        <div key=\"right\" className=\"absolute top-1/2 -right-2 transform -translate-y-1/2 w-2.5 h-14 bg-gray-100 rounded-full\"></div>\r\n      );\r\n    }\r\n    \r\n    if (table.capacity >= 3) {\r\n      // Top seat for 3 or more seats\r\n      seats.push(\r\n        <div key=\"top\" className=\"absolute -top-2 left-1/2 transform -translate-x-1/2 w-14 h-2.5 bg-gray-100 rounded-full\"></div>\r\n      );\r\n    }\r\n    \r\n    if (table.capacity >= 4) {\r\n      // Bottom seat for 4 seats\r\n      seats.push(\r\n        <div key=\"bottom\" className=\"absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-14 h-2.5 bg-gray-100 rounded-full\"></div>\r\n      );\r\n    }\r\n    \r\n    return seats;\r\n  };\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-3 gap-12\">\r\n      {tables.map((table) => {\r\n        const isSelected = selectedTable === table.table_number;\r\n        return (\r\n          <div\r\n            key={table.id}\r\n            className=\"flex items-center  justify-center relative\"\r\n          >\r\n            <div\r\n              className={`relative w-20 h-20 ${isSelected ? \"scale-110\" : \"\"} transition-all m-2  duration-200`}\r\n              onClick={() => setSelectedTable(table.table_number)}\r\n            >\r\n              {renderTableSeats(table)}\r\n              \r\n              {/* Table */}\r\n              <div\r\n                className={`\r\n                  absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 \r\n                  w-16 h-16 rounded-xl flex items-center justify-center\r\n                  ${getTableColor(tableStatus[table.table_number])}\r\n                  ${isSelected ? \"border-2 border-blue-500\" : \"\"}\r\n                  cursor-pointer\r\n                `}\r\n              >\r\n                <span className=\"font-medium text-white text-base\">{table.table_number}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2259, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/real-time/order-panel.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { ChevronRight } from \"lucide-react\"\r\nimport { APISDK, IDineInOrder, IDineInTable, IDineInTableBooking, IDish } from \"@/libs/api\"\r\n\r\ninterface IFilterOrder {\r\n  order_id: string;\r\n  table_id: string;\r\n  updated_at: string;\r\n  items: {\r\n    dish_id: string;\r\n    dish_name: string;\r\n    quantity: number;\r\n    total: number;\r\n    instructions?: string;\r\n    item_status: \"pending\" | \"preparing\" | \"served\" | \"ready\";\r\n  }[];\r\n  total: number;\r\n  status: \"pending\" | \"preparing\" | \"served\" | \"ready\";\r\n}\r\n\r\nexport function OrderPanel(\r\n  {\r\n    orders,\r\n    dishes,\r\n    tables,\r\n    bookings,\r\n  }: Readonly<{\r\n    orders: IDineInOrder[];\r\n    tables: IDineInTable[];\r\n    dishes: IDish[];\r\n    bookings: IDineInTableBooking[];\r\n  }>\r\n) {\r\n  const [activeTab, setActiveTab] = useState(\"preparing\")\r\n  const [filteredOrders, setFilteredOrders] = useState<IFilterOrder[]>([])\r\n  const [loadingOrderId, setLoadingOrderId] = useState<string | null>(null);\r\n  const [tableStats, setTableStats] = useState<IDineInTableStats[]>([]);\r\n\r\n  useEffect(() => {\r\n    const fetchTableStats = async () => {\r\n      const token = localStorage.getItem(\"access_token\");\r\n      if (!token) return;\r\n\r\n      try {\r\n        const api = APISDK.getInstance(token);\r\n        const response = await api.getTableStats();\r\n        setTableStats(response.data);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch table stats:\", error);\r\n      }\r\n    };\r\n\r\n    fetchTableStats();\r\n  }, [orders]);\r\n\r\n  const formatDateTime = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-US', {\r\n      day: '2-digit',\r\n      month: 'short',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n      hour12: true\r\n    }).format(date);\r\n  };\r\n\r\n  const genOrders = orders\r\n    .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())\r\n    .map((order) => {\r\n      const table = tables.find((table) => table.table_number === order.table_id);\r\n      const tableData = tableStats.find(stat => stat.table_number === order.table_id);\r\n\r\n      const orderItems = order.items.map((item, itemIndex) => {\r\n        const dish = dishes.find(d => d.id === item.dish_id);\r\n        // Find the corresponding item status from tableStats\r\n        const itemStatus = order.order_status === 'ready'\r\n          ? item.status\r\n          : (tableData?.items[itemIndex]?.item_status || 'pending');\r\n\r\n        return {\r\n          dish_id: item.dish_id,\r\n          item_index: itemIndex,\r\n          dish_name: dish?.name ?? \"Unknown Dish\",\r\n          quantity: item.quantity,\r\n          total: (dish?.price || 0) * item.quantity,\r\n          instructions: item.instructions,\r\n          item_status: itemStatus as \"pending\" | \"preparing\" | \"served\" | \"ready\" \r\n        };\r\n      });\r\n\r\n      const total = orderItems.reduce((sum: number, item) => sum + item.total, 0);\r\n\r\n      return {\r\n        order_id: order.id,\r\n        table_id: table?.table_number ?? \"Unknown\",\r\n        items: orderItems,\r\n        total,\r\n        status: order.order_status as 'pending' | 'preparing' | 'served' | 'ready',\r\n        updated_at: order.updated_at.toString()\r\n      };\r\n    });\r\n  // Calculate counts for each tab\r\n  const tabCounts = {\r\n    pending: genOrders.filter(order => order.status === 'pending').length,\r\n    preparing: genOrders.filter(order => order.status === 'preparing').length,\r\n    served: genOrders.filter(order => order.status === 'served').length,\r\n    ready: genOrders.filter(order => order.status === 'ready').length,\r\n  }\r\n\r\n  const tabs = [\r\n    { id: \"pending\", label: \"New Orders\", count: tabCounts.pending },\r\n    { id: \"preparing\", label: \"Preparing\", count: tabCounts.preparing },\r\n    { id: \"served\", label: \"Served\", count: tabCounts.served },\r\n    { id: \"ready\", label: \"Ready\", count: tabCounts.ready },\r\n  ]\r\n\r\n  const getStatusDisplay = (status: string | undefined) => {\r\n    if (!status) return '';\r\n    return status.charAt(0).toUpperCase() + status.slice(1);\r\n  };\r\n\r\n  // Filter orders based on active tab\r\n  useEffect(() => {\r\n    setFilteredOrders(genOrders.filter(order => order.status === activeTab));\r\n  }, [activeTab, orders, bookings, dishes, tables]);\r\n\r\n  const handleStatusChange = async (order: IFilterOrder) => {\r\n    setLoadingOrderId(order.order_id);\r\n    const token = localStorage.getItem(\"access_token\");\r\n    if (!token) {\r\n      console.error(\"No access token found in localStorage\");\r\n      setLoadingOrderId(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const api = APISDK.getInstance(token);\r\n      let nextStatus: 'pending' | 'preparing' | 'served' | 'ready';\r\n\r\n      switch (order.status) {\r\n        case 'pending':\r\n          nextStatus = 'preparing';\r\n          await api.markOrderAsPreparing(order.order_id);\r\n          break;\r\n        case 'preparing':\r\n          nextStatus = 'served';\r\n          await api.markOrderAsServed(order.order_id);\r\n          break;\r\n        case 'served':\r\n          nextStatus = 'ready';\r\n          await api.markOrderAsReady(order.order_id);\r\n          break;\r\n        default:\r\n          nextStatus = 'ready';\r\n      }\r\n\r\n      // Update local state\r\n      setFilteredOrders(prev =>\r\n        prev.map(o => o.order_id === order.order_id ? { ...o, status: nextStatus } : o)\r\n      );\r\n\r\n      // Wait for parent component to fetch new data\r\n      await new Promise(resolve => {\r\n        const checkInterval = setInterval(() => {\r\n          const updatedOrder = orders.find(o => o.id === order.order_id);\r\n          if (updatedOrder && updatedOrder.order_status === nextStatus) {\r\n            clearInterval(checkInterval);\r\n            resolve(true);\r\n          }\r\n        }, 500); // Check every 500ms\r\n\r\n        // Set a timeout to prevent infinite loading\r\n        setTimeout(() => {\r\n          clearInterval(checkInterval);\r\n          resolve(false);\r\n        }, 10000); // Maximum 10 seconds wait\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error(\"Failed to update order status:\", error);\r\n    } finally {\r\n      setLoadingOrderId(null);\r\n    }\r\n  }\r\n\r\n  // Get button text based on current status\r\n  // Modify the getButtonText function\r\n  const getButtonText = (status: string) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return 'Start Preparing';\r\n      case 'preparing':\r\n        return 'Mark as Served';\r\n      case 'served':\r\n        return 'Complete Order';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  const handleRemoveItem = async (order: IFilterOrder, dish_id: string, itemIndex: number) => {\r\n    if (window.confirm(\"This will remove the item from the current order. Proceed?\")) {\r\n      // Keep all items except the one at the specified index\r\n      const updatedItems = order.items\r\n        .filter((_, index) => index !== itemIndex)\r\n        .map(item => ({\r\n          dish_id: item.dish_id,\r\n          quantity: item.quantity,\r\n          status: item.item_status,\r\n          instructions: item.instructions\r\n        }));\r\n\r\n      const token = localStorage.getItem(\"access_token\");\r\n      if (!token) {\r\n        console.error(\"No access token found in localStorage\");\r\n        return;\r\n      }\r\n\r\n      const api = APISDK.getInstance(token);\r\n\r\n      try {\r\n        await api.updateOrDeleteOrder(order.order_id, { items: updatedItems });\r\n      } catch (error) {\r\n        console.error(\"Failed to update order:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white border rounded-lg overflow-hidden\">\r\n      {/* Tabs */}\r\n      <div className=\"flex border-b\">\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            className={`flex-1 py-3 cursor-pointer text-center relative ${activeTab === tab.id ? \"text-orange-500 font-medium\" : \"text-gray-600\"\r\n              }`}\r\n            onClick={() => setActiveTab(tab.id)}\r\n          >\r\n            {tab.label}\r\n            <span className=\"ml-1 bg-gray-100 text-gray-700 text-xs px-1.5 py-0.5 rounded-full\">{tab.count}</span>\r\n            {activeTab === tab.id && <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-orange-500\"></div>}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Order cards */}\r\n      <div className=\"p-4 space-y-4\">\r\n        {filteredOrders.length === 0 ? (\r\n          <div className=\"text-center py-8 text-gray-500\">\r\n            No {activeTab} orders at the moment\r\n          </div>\r\n        ) : (\r\n          // Reverse the filteredOrders array to show new orders at the bottom\r\n          filteredOrders.map((order) => (\r\n            <div key={order.order_id} className=\"border rounded-lg overflow-hidden\">\r\n              <div className=\"p-4\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"w-10 h-10 bg-gray-200 rounded-full mr-3 flex items-center justify-center\">\r\n                      <svg className=\"w-6 h-6 text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path\r\n                          strokeLinecap=\"round\"\r\n                          strokeLinejoin=\"round\"\r\n                          strokeWidth={2}\r\n                          d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n                        />\r\n                      </svg>\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"font-medium text-gray-800\">Table - {order.table_id}</h3>\r\n                      <div className=\"flex flex-col\">\r\n                        <p className=\"text-sm text-blue-400\">\r\n                          Order #{order.order_id.substring(0, 8)}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-500\">\r\n                          Last updated: {formatDateTime(order.updated_at)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                  {order.items.map((item, index) => (\r\n                    <div key={index}>\r\n                      <div className=\"flex items-center justify-between mb-1\">\r\n                        <div className=\"flex-1\">\r\n                          <span className=\"text-gray-700\">{item.dish_name}</span>\r\n                          <span className=\"text-gray-500 text-sm ml-2\">×{item.quantity}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className={`text-xs px-2 py-1 rounded-full ${item.item_status === 'pending' ? 'bg-gray-100 text-gray-600' :\r\n                              item.item_status === 'preparing' ? 'bg-orange-100 text-orange-600' :\r\n                                item.item_status === 'served' ? 'bg-green-100 text-green-600' :\r\n                                  item.item_status === 'ready' ? 'bg-blue-100 text-blue-600' :\r\n                                    'bg-gray-100 text-gray-600' // for unknown status\r\n                            }`}>\r\n                            {getStatusDisplay(item.item_status)}\r\n                          </span>\r\n                          {order.status === 'pending' && item.item_status === 'pending' && (\r\n                            <button\r\n                              onClick={() => handleRemoveItem(order, item.dish_id, index)}\r\n                              className=\"text-red-500 mx-1\"\r\n                            >\r\n                              Remove\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      {item.instructions && (\r\n                        <p className=\"text-sm text-gray-500 italic\">\r\n                          Note: {item.instructions}\r\n                        </p>\r\n                      )}\r\n                      <div className=\"text-sm text-gray-600\">\r\n                        ₹{item.total}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  <div className=\"mt-3 pt-3 border-t\">\r\n                    <div className=\"text-sm font-medium text-gray-900\">\r\n                      Total: ₹{order.total}\r\n                    </div>\r\n                    {order.status !== 'ready' && (\r\n                      <div className=\"flex gap-2 mt-2\">\r\n                        <button\r\n                          onClick={() => handleStatusChange(order)}\r\n                          disabled={loadingOrderId === order.order_id}\r\n                          className={`flex-1 ${loadingOrderId === order.order_id\r\n                            ? 'bg-gray-400 cursor-not-allowed'\r\n                            : 'bg-orange-500 hover:bg-orange-600'\r\n                            } text-white py-2 px-4 rounded transition duration-200`}\r\n                        >\r\n                          {loadingOrderId === order.order_id\r\n                            ? 'Processing...'\r\n                            : getButtonText(order.status)\r\n                          }\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2779, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/components/dashboard-header.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useRef, useEffect } from \"react\"\r\nimport { Bell, Loader2 } from \"lucide-react\"\r\nimport { APISDK } from \"@/libs/api\"\r\nimport { IAssistance } from \"@/libs/api\"\r\n\r\nexport function DashboardHeader() {\r\n  const [showNotifications, setShowNotifications] = useState(false)\r\n  const [assistances, setAssistances] = useState<IAssistance[]>([])\r\n  const [clearingIds, setClearingIds] = useState<string[]>([])\r\n  const notificationRef = useRef<HTMLDivElement | null>(null)\r\n  const audioRef = useRef<HTMLAudioElement | null>(null)\r\n\r\n  useEffect(() => {\r\n    // Create audio element for notification\r\n    audioRef.current = new Audio(\"/sound.mp3\")\r\n    \r\n    // Request permission and play a silent audio to enable sound\r\n    const enableAudio = async () => {\r\n      try {\r\n        await audioRef.current?.play()\r\n        // Immediately pause it\r\n        audioRef.current?.pause()\r\n        audioRef.current!.currentTime = 0\r\n      } catch (err) {\r\n        console.error(\"Failed to enable audio:\", err)\r\n      }\r\n    }\r\n\r\n    // Enable audio on first user interaction\r\n    const handleInteraction = () => {\r\n      enableAudio()\r\n      // Remove the event listeners after first interaction\r\n      document.removeEventListener('click', handleInteraction)\r\n      document.removeEventListener('touchstart', handleInteraction)\r\n    }\r\n\r\n    document.addEventListener('click', handleInteraction)\r\n    document.addEventListener('touchstart', handleInteraction)\r\n\r\n    // Cleanup\r\n    return () => {\r\n      document.removeEventListener('click', handleInteraction)\r\n      document.removeEventListener('touchstart', handleInteraction)\r\n    }\r\n  }, [])\r\n\r\n  // Fetch assistance data with polling\r\n  useEffect(() => {\r\n    async function fetchAssistances() {\r\n      try {\r\n        const response = await APISDK.getInstance().getAllAssistance()\r\n        // Check for new assistances and play sound\r\n        if (assistances.length < response.data.length) {\r\n          audioRef.current?.play()\r\n        }\r\n        setAssistances(response.data)\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch assistance data:\", error)\r\n      }\r\n    }\r\n\r\n    fetchAssistances() // Initial fetch\r\n    const interval = setInterval(fetchAssistances, 5000) // Poll every 5 seconds\r\n\r\n    return () => clearInterval(interval)\r\n  }, [assistances.length])\r\n\r\n  // Handle clearing assistance\r\n  const handleClearAssistance = async (id: string) => {\r\n    try {\r\n      setClearingIds((prev) => [...prev, id])\r\n      await APISDK.getInstance().deleteAssistance(id)\r\n      setAssistances((prev) => prev.filter((assistance) => assistance.id !== id))\r\n    } catch (error) {\r\n      console.error(\"Failed to delete assistance:\", error)\r\n    } finally {\r\n      setClearingIds((prev) => prev.filter((clearId) => clearId !== id))\r\n    }\r\n  }\r\n\r\n  return (\r\n    <header className=\"h-16 border-b flex items-center justify-end px-6\">\r\n      <div className=\"flex justify-end items-center\">\r\n        <div className=\"relative\" ref={notificationRef}>\r\n          <button\r\n            className=\"p-2 rounded-full hover:bg-indigo-50 relative transition-colors\"\r\n            onClick={() => setShowNotifications(!showNotifications)}\r\n          >\r\n            <Bell size={20} className=\"text-indigo-600\" />\r\n            {assistances.length > 0 && (\r\n              <span className=\"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse\"></span>\r\n            )}\r\n          </button>\r\n\r\n          {showNotifications && (\r\n            <div className=\"absolute right-0 mt-2 w-80 bg-white border border-indigo-100 rounded-lg shadow-lg z-50\">\r\n              <div className=\"p-3 space-y-2\">\r\n                {assistances.length === 0 ? (\r\n                  <div className=\"text-center text-gray-500 py-4\">\r\n                    No assistance requests\r\n                  </div>\r\n                ) : (\r\n                  assistances.map((assistance) => (\r\n                    <div \r\n                      key={assistance.id} \r\n                      className=\"border border-indigo-100 rounded-lg p-3 bg-white hover:bg-indigo-50 transition-colors\"\r\n                    >\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <span className=\"font-medium text-indigo-900\">\r\n                          Table No: {assistance.table_number}\r\n                        </span>\r\n                        <button\r\n                          className={`px-4 py-1.5 rounded-md text-sm font-medium transition-colors\r\n                            ${clearingIds.includes(assistance.id)\r\n                              ? 'bg-gray-100 text-gray-400 cursor-not-allowed'\r\n                              : 'bg-red-500 hover:bg-red-600 text-white'\r\n                            }`}\r\n                          onClick={() => handleClearAssistance(assistance.id)}\r\n                          disabled={clearingIds.includes(assistance.id)}\r\n                        >\r\n                          {clearingIds.includes(assistance.id) ? (\r\n                            <Loader2 size={16} className=\"animate-spin\" />\r\n                          ) : (\r\n                            'Clear'\r\n                          )}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"text-indigo-600 text-sm mt-1\">Requested Assistance</div>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </header>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2997, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Charan%20Kosari/Desktop/jeevic_admin/app/real-time/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { Breadcrumb } from \"@/components/breadcrumb\"\r\nimport TableGridSystem from \"@/components/real-time/table-grid\"\r\nimport { OrderPanel } from \"@/components/real-time/order-panel\"\r\nimport { DashboardHeader } from \"@/components/dashboard-header\"\r\nimport { APISDK, IDineInOrder, IDineInTable, IDineInTableBooking, IDish } from \"@/libs/api\"\r\nimport { useEffect, useState } from \"react\"\r\n\r\nexport default function RealTimePage() {\r\n  const [tables, setTables] = useState<IDineInTable[]>([])\r\n  const [orders, setOrders] = useState<IDineInOrder[]>([])\r\n  const [bookings, setBookings] = useState<IDineInTableBooking[]>([])\r\n  const [dishes, setDishes] = useState<IDish[]>([])\r\n  const [tableStates, setTableStates] = useState<IDineInTableStats[]>([])\r\n\r\n  const [isLoading, setIsLoading] = useState(true)\r\n\r\n  const fetchData = async (token: string) => {\r\n    try {\r\n      const api = APISDK.getInstance(token);\r\n      const [\r\n        tables,\r\n        orders,\r\n        bookings,\r\n        dishes,\r\n        tableStats\r\n      ] = await Promise.all([\r\n        api.getTables(),\r\n        api.getOrders(),\r\n        api.getBookings(),\r\n        api.getDishes(),\r\n        api.getTableStats()\r\n      ]);\r\n\r\n\r\n      setTables(tables.data);\r\n      setOrders(orders.data);\r\n      setBookings(bookings.data);\r\n      setDishes(dishes);\r\n\r\n      const updatedTableStats = tableStats.data.map((tableStat: IDineInTableStats) => {\r\n        const matchingBooking = bookings.data.find((booking: IDineInTableBooking) => \r\n            booking.id === tableStat.booking_id\r\n        );\r\n\r\n        if (matchingBooking && matchingBooking.is_ready_to_bill) {\r\n            console.log(\"Changed TableStat:\", { ...tableStat, status: \"Ready to Bill\" });\r\n            return {\r\n                ...tableStat,\r\n                status: \"Ready to Bill\"\r\n            };\r\n        }\r\n\r\n        // Check if the table needs to be marked as \"To be Cleaned\"\r\n        const table = tables.data.find((t: IDineInTable) => t.id === tableStat.table_number);\r\n        if (table && table.meta_data.status === 'Untouched' && table.meta_data.to_be_cleaned === true) {\r\n          console.log(\"Changed TableStat:\", { ...tableStat, status: \"To be Cleaned\" });\r\n          return {\r\n              ...tableStat,\r\n              status: \"To be Cleaned\"\r\n          };\r\n      }\r\n  \r\n\r\n        console.log(\"Unchanged TableStat:\", tableStat);\r\n        return tableStat;\r\n    });\r\n\r\n    setTableStates(updatedTableStats);\r\n\r\n      setIsLoading(false);\r\n    } catch (error) {\r\n      console.error(\"Error fetching data:\", error);\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"access_token\");\r\n    if (token) {\r\n      fetchData(token);\r\n    }\r\n  }, []);\r\n\r\n  // refetch the data every 5 seconds\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const token = localStorage.getItem(\"access_token\");\r\n      if (token) {\r\n        fetchData(token);\r\n      }\r\n    }, 5000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      console.log(\"Updated Table States:\", tableStates);\r\n    }\r\n  }, [tableStates, isLoading]);\r\n\r\n  if (isLoading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex justify-between \">\r\n      <Breadcrumb items={[\"Cafe\", \"Real-Time view\"]} /><DashboardHeader />\r\n      </div>\r\n      <main className=\"flex-1 p-6\">\r\n        <h2 className=\"text-lg text-gray-800 font-medium mb-4\">Table Management</h2>\r\n\r\n        <div className=\"flex flex-col lg:flex-row gap-6\">\r\n          <div className=\"lg:w-1/2 xl:w-7/12\">\r\n            <div className=\"bg-white border rounded-lg p-4\">\r\n              <TableGridSystem tables={tables} setTables={setTables} tableStates={tableStates} />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right side - Orders and Bill */}\r\n          <div className=\"lg:w-1/2 xl:w-5/12 flex flex-col gap-6\">\r\n            <OrderPanel orders={orders} tables={tables} dishes={dishes} bookings={bookings} />\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </>\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}